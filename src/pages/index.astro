---
import PageLayout from "@/layouts/PageLayout.astro";
import { getImage } from "astro:assets";
import cookieCoffe from "/public/assets/cookies_n_coffee.png";
import { getSortedPosts, optimizePostImages } from "@/util/posts-utils";
import Card from "@/components/segments/Card";

const oCookieCoffe = await getImage({ src: cookieCoffe });

const description = "AllTheCookies é um pequeno blog colaborativo de tecnologia. Tendo como conteúdo notícias, tutoriais & artigos pessoais.";

const sortedPosts = await optimizePostImages(await getSortedPosts());
const latestPost = sortedPosts[0];
const otherPosts = sortedPosts.slice(1, 3);
---


<PageLayout>

<!-- greeting -->
<section class="py-12 md:py-6 max-w-5xl mx-auto xl:px-8 md:flex items-center justify-center">
  <div class="text-skin-base">
    <h1 class="text-3xl lg:text-4xl font-bold pb-2">Bem vindo! <span class="text-skin-alternate">Aceite</span> nossos cookies.</h1>
    <p class="text-md text-skin-muted lg:text-lg max-w-xl overflow-hidden text-ellipsis">{description}</p>
  </div>
  <div class="flex justify-center md:justify-start">
    <div class="relative w-fit">
      <div class="absolute bg-glow-primary inset-5 blur opacity-0 hover:opacity-[0.03] rounded-full transition-opacity ease-in"></div>
      <img src={oCookieCoffe.src} alt="Cookie with coffe" class="w-[200px] xl:w-[280px]" loading="lazy" decoding="async">
    </div>
  </div>
</section>

<!-- search -->
<section>
</section>

<!-- latest posts -->
<!-- TODO: change to carousel -->
<section class="w-full py-5 rounded-md">
  <h3 class="text-skin-base text-center py-1 md:py-2.5 font-bold text-xl sm:text-2xl">Nossas <span class="text-skin-accent-secondary">últimas</span> postagens</h3> 
  <div class="grid grid-cols-1 mt-4 md:grid-cols-3 max-w-4xl md:mx-auto">
    <div class="md:col-span-2 mx-auto mb-3 max-md:max-w-md md:max-w-xl">
      <Card post={latestPost} special={true} />
    </div>
    <div>
      {otherPosts.map(post => (<div class="md:col-span-1 md:mx-2 md:place-self-start mx-auto max-w-md mb-3">
        <Card post={post} />
      </div>))}
    </div>
  </div>
</section>

</PageLayout>

---
import "@/styles/base.css";

import Layout from "./BaseLayout.astro";
import Header from "@/components/base/Header.astro";
import Sidebar from "@/components/base/Sidebar";
import Footer from "@/components/base/Footer.astro";
import background from "/public/bg.png";

import { getImage } from "astro:assets";

const optimizedBg = await getImage({ src: background });
---

<Layout>
  <!-- 
    client:media only loads the component JS when a css condition is met 
  -->
  <Header />
  <Sidebar client:media="(max-width: 1024px)" />

  <main class="mx-auto max-w-7xl items-center pb-10 px-10 relative">
    <div style={`background-image: url('${optimizedBg.src}')`} class="left-0 absolute h-full 
      w-full -z-20 background-opacity rotate-1 bg-contain"></div>
    <slot />
  </main>

  <Footer />

  <script>
    import { setPreferredTheme } from "@/assets/stores/theme-store";

    setPreferredTheme();
  </script>
</Layout>
